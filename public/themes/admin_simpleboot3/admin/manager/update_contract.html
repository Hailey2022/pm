<include file="public@header" />
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>合同</title>
    <script type="text/html" id="files-item-tpl">
        <li id="saved-file{id}">
            <input class="form-control" id="file-{id}" type="hidden" name="file_urls[]" value="{filepath}">
            <input class="form-control" id="file-{id}-name" type="text" name="file_names[]" value="{name}"
                   style="width: 200px;" title="文件名称">
            <a class="btn" id="file-{id}-preview" href="{preview_url}" target="_blank">下载</a>
            <a class="btn" href="javascript:uploadOne('文件上传','#file-{id}','file');">替换</a>
            <a class="btn" href="javascript:(function(){$('#saved-file{id}').remove();})();">移除</a>
        </li>
    </script>
</head>

<body>
    <form method="post" class="form-horizontal js-ajax-form margin-top-20"
        action="{:url('manager/postContractUpdate')}">
        <div class="form-group">
            <label for="input-user_login" class="col-sm-2 control-label">服务商</label>
            <div class="col-md-6 col-sm-10">
                <input class="form-control" id="input-user_login" type="text" disabled
                    value={$data.user_login}>
            </div>
        </div>

        <div class="form-group">
            <label for="input-contractName" class="col-sm-2 control-label">合同名称</label>
            <div class="col-md-6 col-sm-10">
                <input class="form-control" id="input-contractName" name="contractName" type="text"
                    value={$data.contractName}>
            </div>
        </div>

        <div class="form-group">
            <label for="input-contractAmount" class="col-sm-2 control-label">合同金额</label>
            <div class="col-md-6 col-sm-10">
                <input class="form-control" id="input-contractAmount" name="contractAmount" type="text"
                    value={$data.contractAmount}>
            </div>
        </div>

        <div class="form-group">
            <label for="input-contractTime" class="col-sm-2 control-label">合同时间</label>
            <div class="col-md-6 col-sm-10">
                <input class="form-control" id="input-contractTime" name="contractTime" type="text"
                    value={$data.contractTime}>
            </div>
        </div>

        <div class="form-group">
            <label for="input-contractNumber" class="col-sm-2 control-label">合同编号</label>
            <div class="col-md-6 col-sm-10">
                <input class="form-control" id="input-contractNumber" name="contractNumber" type="text"
                    value={$data.contractNumber}>
            </div>
        </div>
        <div class="">
            <label for="input-contractNumber" class="col-sm-2 control-label">附件</label>
            <div class="col-md-6 col-sm-10">
                <tr>
                    <td>
                        <ul id="files" class="pic-list list-unstyled form-inline">
                            <notempty name="files">
                                <foreach name="files" key="url" item="name">
                                    <php>$file_url=cmf_get_file_download_url($url);</php>
                                    <php>$file_id=hash("sha256", $url);</php>
                                    <li id="saved-file{$file_id}">
                                        <input class="form-control" id="file-{$file_id}" type="hidden"
                                            name="file_urls[]" value="{$url}">
                                        <input class="form-control" id="file-{$file_id}-name" type="text"
                                            name="file_names[]" value="{$name}" style="width: 200px;" title="文件名称">
                                        <a class="btn" id="file-{$file_id}-preview" href="{$file_url}" target="_blank"
                                            download="{$name}">下载</a>
                                        <a class="btn"
                                            href="javascript:uploadOne('文件上传','#file-{$file_id}','file');">替换</a>
                                        <a class="btn"
                                            href="javascript:(function(){$('#saved-file{$file_id}').remove();})();">移除</a>
                                    </li>
                                </foreach>
                            </notempty>
                        </ul>
                        <a href="javascript:uploadMultiFile('附件上传','#files','files-item-tpl','file');"
                            class="btn btn-default">选择文件</a>
                    </td>
                </tr>
            </div>
        </div>
        <div class="form-group">
            <input name="contractId" hidden value={$data.contractId}>
        </div>

        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-primary js-ajax-submit">更新</button>
                <a class="btn btn-default adminuse" href="javascript:history.go(-1)">返回</a>
            </div>
        </div>
    </form>

</html>

<script type="text/javascript" src="__STATIC__/js/admin.js"></script>
<script type="text/javascript" src="__STATIC__/js/frontend.js"></script>