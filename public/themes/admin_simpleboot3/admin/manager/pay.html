<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>新增支付</title>
    <link rel="stylesheet" type="text/css" href="__STATIC__/css/xf_ui.css" />
    <script type="text/html" id="tpl">
        <div id="file-{id}">
            <upload_span></upload_span>
            <xfpreview onclick="xfPreview('/upload/{filepath}')">预览</xfpreview>
            <xfdelete onclick="javascript:handleDelete('#file-{id}');">删除</xfdelete>
            <input type="text" autocomplete="off" name="file_name_{key}[]" value="{name}">
            <input type="text" autocomplete="off" hidden name="file_url_{key}[]" value="{filepath}">
        </div>
    </script>
</head>
<script type="text/javascript">
    var GV = {
        ROOT: "__ROOT__/",
        WEB_ROOT: "__WEB_ROOT__/",
        JS_ROOT: "static/js/",
    };
</script>
<script src="__STATIC__/js/jquery.js"></script>
<script src="__STATIC__/js/wind.js"></script>
<script src="__STATIC__/js/admin.js"></script>
<script src="__STATIC__/xf/xf.js"></script>

<body>
    <include file="manager/left_menu" projectID="${projectId|default=''}" />
    <div class="main">
        <div class="main_menu">
            <a href="{:url('manager/listProjectPayments', ['projectId'=>$projectId])}">支付信息</a>
            <a href="{:url('manager/pay', ['projectId'=>$projectId])}" class="on add">新增支付</a>
        </div>
    <form method="post" class="form-horizontal js-ajax-form margin-top-20" action="{:url('manager/postPaymentAdd')}">
        <div class="xf_input">
            <h4 class="xf_input_h4">工程支付</h4>
            <ul>
                <li>
                    <span>工程名称：</span>
                    <input type="text" autocomplete="off" value="{$projectName}" disabled>
                </li>
                <li>
                    <span>合同名称：</span>
                    <select name="contractId" required style="width: 650px;">
                        <option value="">请选择合同</option>
                        <foreach name="contracts" item="c">
                            <option value="{$c.contractId}">{$c.user_login} - {$c.contractName}</option>
                        </foreach>
                    </select>
                </li>
                <li>
                    <span>进度款（期数）：</span>
                    <input type="text" autocomplete="off" name="installment" value="">
                </li>
                <li>
                    <span>合计：</span>
                    <input id="sum" disabled />
                    <!-- <span class="xf_ser">万元：</span>
                    <input id="10k-contractAmount" type="text" autocomplete="off" disabled value=""> -->
                </li>
                <li id="{:md5(uniqid(md5(microtime(true)),true))}">
                    <span>中央：</span>
                    <input required class="to10k" type="number" step="0.01" min=0 autocomplete="off" name="ccp">
                    <span class="xf_ser">万元：</span>
                    <input type="text" autocomplete="off" value="" disabled>
                </li>
                <li id="{:md5(uniqid(md5(microtime(true)),true))}">
                    <span>省：</span>
                    <input required class="to10k" type="number" step="0.01" min=0 autocomplete="off" name="province">
                    <span class="xf_ser">万元：</span>
                    <input type="text" autocomplete="off" value="" disabled>
                </li>
                <li id="{:md5(uniqid(md5(microtime(true)),true))}">
                    <span>市：</span>
                    <input required class="to10k" type="number" step="0.01" min=0 autocomplete="off" name="city">
                    <span class="xf_ser">万元：</span>
                    <input type="text" autocomplete="off" value="" disabled>
                </li>
                <li id="{:md5(uniqid(md5(microtime(true)),true))}">
                    <span>专项债(区)：</span>
                    <input required class="to10k" type="number" step="0.01" min=0 autocomplete="off" name="bond">
                    <span class="xf_ser">万元：</span>
                    <input type="text" autocomplete="off" value="" disabled>
                </li>
                <li id="{:md5(uniqid(md5(microtime(true)),true))}">
                    <span>预算(区)：</span>
                    <input required class="to10k" type="number" step="0.01" min=0 autocomplete="off" name="budget">
                    <span class="xf_ser">万元：</span>
                    <input type="text" autocomplete="off" value="" disabled>
                </li>
                <li id="{:md5(uniqid(md5(microtime(true)),true))}">
                    <span>其他：</span>
                    <input required class="to10k" type="number" step="0.01" min=0 autocomplete="off" name="others">
                    <span class="xf_ser">万元：</span>
                    <input type="text" autocomplete="off" value="" disabled>
                </li>
                <li>
                    <span>备注：</span>
                    <textarea type="text" rows="4" cols="40" autocomplete="off" name="comment" value=""></textarea>
                </li>
                <li id="{:md5(uniqid(md5(microtime(true)),true))}">
                    <span>支付凭证附件：</span>
                    <xfupload file_id="1">上传</xfupload>
                </li>
                <li id="{:md5(uniqid(md5(microtime(true)),true))}">
                    <span>支金来源凭证附件：</span>
                    <xfupload file_id="2">上传</xfupload>
                </li>
            </ul>
        </div>
        <xf_submit><button id="project_submit">提交</button></xf_submit>

    </form>
    </div>
    <script>
        $(".to10k").on("change keyup", function () {
            var s = 0;
            $(".to10k").each(function () {
                s += Number($(this).val())
            })
            $("#sum").val(s)
        })
    </script>
</body>

</html>